<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa del Amor - Aventura Rom√°ntica</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Playfair+Display:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Playfair Display', serif;
            background: transparent;
            min-height: 100vh;
            overflow-x: auto;
            position: relative;
        }
        
        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .title {
            text-align: center;
            font-family: 'Dancing Script', cursive;
            font-size: 3.5rem;
            color: #654321;
            text-shadow: 
                2px 2px 4px rgba(0,0,0,0.4),
                0 0 10px rgba(184, 134, 11, 0.4),
                0 0 20px rgba(139, 69, 19, 0.2);
            margin-bottom: 20px;
            transform: rotate(-1deg);
        }
        
        .subtitle {
            text-align: center;
            font-size: 1.2rem;
            color: #8B4513;
            margin-bottom: 30px;
            font-style: italic;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        
        .map-container {
            position: relative;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            background: url("back.png");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            border: 12px solid #654321;
            border-radius: 25px;
            box-shadow: 
                0 0 50px rgba(101, 67, 33, 0.6),
                inset 0 0 30px rgba(139, 69, 19, 0.2);
            padding: 40px;
            min-height: 600px;
            position: relative;
        }
        
        .map-container::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 15px;
            right: 15px;
            bottom: 15px;
            border: 2px solid #8B4513;
            border-radius: 20px;
            pointer-events: none;
            border-style: dashed;
        }
        
        .map-container::after {
            content: 'üß≠';
            position: absolute;
            top: 25px;
            right: 25px;
            font-size: 2.5rem;
            opacity: 0.7;
            transform: rotate(15deg);
        }
        
        .map-grid {
            position: relative;
            width: 100%;
            height: 600px;
            background: transparent;
        }
        
        .location {
            position: absolute;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 
                0 8px 20px rgba(0,0,0,0.3),
                0 0 0 4px #8B4513,
                0 0 0 8px #A0522D;
            border: 3px solid #F5DEB3;
            opacity: 0.5;
            z-index: 10;
        }
        
        .location.active {
            opacity: 1;
            animation: treasureGlow 2s infinite;
            box-shadow: 
                0 8px 20px rgba(0,0,0,0.4),
                0 0 0 4px #8B4513,
                0 0 0 8px #A0522D,
                0 0 20px rgba(255, 215, 0, 0.6);
        }
        
        .location.completed {
            opacity: 0.9;
            transform: scale(0.95);
            box-shadow: 
                0 6px 15px rgba(0,0,0,0.3),
                0 0 0 4px #228B22,
                0 0 0 8px #32CD32;
            border-color: #90EE90;
        }
        
        .location:hover.active {
            transform: scale(1.2);
            box-shadow: 
                0 12px 30px rgba(0,0,0,0.4),
                0 0 0 4px #8B4513,
                0 0 0 8px #A0522D,
                0 0 30px rgba(255, 215, 0, 0.8);
        }
        
        @keyframes treasureGlow {
            0%, 100% { 
                transform: scale(1);
                filter: brightness(1);
            }
            50% { 
                transform: scale(1.05);
                filter: brightness(1.2);
            }
        }
        

        
        .park {
            top: 50px;
            left: 495px;
            background: linear-gradient(135deg, #98FB98, #90EE90);
        }
        
        .cafe {
            top: 150px;
            left: 430px;
            background: linear-gradient(135deg, #DEB887, #F4A460);
        }
        
        .library {
            top: 350px;
            left: 200px;
            background: linear-gradient(135deg, #9370DB, #BA55D3);
        }
        
        .bridge {
            top: 450px;
            left: 500px;
            background: linear-gradient(135deg, #87CEEB, #B0E0E6);
        }
        
        .garden {
            top: 150px;
            left: 650px;
            background: linear-gradient(135deg, #FFB6C1, #FFC0CB);
        }
        
        .surprise {
            top: 320px;
            left: 750px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .treasure-path {
            position: absolute;
            height: 6px;
            background: 
                repeating-linear-gradient(90deg, 
                    #8B4513 0px, #8B4513 8px, 
                    transparent 8px, transparent 12px);
            border-radius: 3px;
            opacity: 0.8;
            box-shadow: 
                0 2px 4px rgba(0,0,0,0.3),
                inset 0 1px 1px rgba(255,255,255,0.1);
            z-index: 5;
        }
        
        .treasure-path::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: 
                repeating-linear-gradient(90deg, 
                    rgba(139, 69, 19, 0.3) 0px, rgba(139, 69, 19, 0.3) 8px, 
                    transparent 8px, transparent 12px);
            border-radius: 5px;
            z-index: -1;
        }
        
        .path1 {
            top: 110px;
            left: 220px;
            width: 150px;
            transform: rotate(20deg);
        }
        
        .path2 {
            top: 250px;
            left: 420px;
            width: 120px;
            transform: rotate(-60deg);
        }
        
        .path3 {
            top: 400px;
            left: 270px;
            width: 140px;
            transform: rotate(35deg);
        }
        
        .path4 {
            top: 480px;
            left: 570px;
            width: 130px;
            transform: rotate(-25deg);
        }
        
        .path5 {
            top: 180px;
            left: 720px;
            width: 110px;
            transform: rotate(70deg);
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
        }
        
        .modal-content {
            background: linear-gradient(135deg, #FFF0F5, #FFE4E1);
            margin: 3% auto;
            padding: 30px;
            border: 6px solid #D8537A;
            border-radius: 20px;
            width: 90%;
            max-width: 700px;
            text-align: center;
            box-shadow: 0 0 40px rgba(216, 83, 122, 0.4);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal h2 {
            color: #8B0045;
            font-family: 'Dancing Script', cursive;
            font-size: 2.5rem;
            margin-bottom: 25px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }
        
        .modal p {
            color: #4A4A4A;
            font-size: 1.3rem;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        
        .challenge-text {
            background: rgba(255, 182, 193, 0.3);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #FF69B4;
            font-weight: bold;
            color: #8B0045;
        }
        
        .quiz-container {
            display: none;
            margin: 20px 0;
        }
        
        .photo-challenge-container {
            display: none;
            margin: 20px 0;
        }
        
        .pose-card {
            background: rgba(255, 255, 255, 0.9);
            border: 3px solid #FFB6C1;
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 182, 193, 0.3);
        }
        
        .pose-card.completed {
            border-color: #228B22;
            background: rgba(144, 238, 144, 0.2);
        }
        
        .pose-emoji {
            font-size: 4rem;
            margin-bottom: 15px;
            display: block;
        }
        
        .pose-image {
            width: 200px;
            height: 150px;
            margin: 15px auto;
            border: 3px solid #FFB6C1;
            border-radius: 15px;
            background: linear-gradient(135deg, #FFF0F5, #FFE4E1);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(255, 182, 193, 0.3);
        }
        
        .pose-name {
            color: #8B0045;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
            font-family: 'Dancing Script', cursive;
        }
        
        .pose-description {
            color: #4A4A4A;
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .pose-tips {
            background: rgba(255, 182, 193, 0.2);
            padding: 12px;
            border-radius: 10px;
            font-style: italic;
            color: #8B0045;
            margin-bottom: 20px;
            border-left: 4px solid #FF69B4;
        }
        
        .pose-button {
            background: linear-gradient(135deg, #FF69B4, #FFB6C1);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1.1rem;
            font-family: 'Playfair Display', serif;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .pose-button:hover {
            background: linear-gradient(135deg, #FFB6C1, #FF69B4);
            transform: translateY(-2px);
        }
        
        .pose-button.completed {
            background: linear-gradient(135deg, #90EE90, #98FB98);
            color: #006400;
        }
        
        .photo-progress {
            text-align: center;
            margin: 20px 0;
            font-size: 1.2rem;
            color: #8B0045;
            font-weight: bold;
        }
        
        .question {
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            border: 2px solid #FFB6C1;
        }
        
        .question h3 {
            color: #8B0045;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .character-image-container {
            text-align: center;
            margin: 20px 0;
        }
        
        .character-image {
            width: 200px;
            height: 250px;
            object-fit: cover;
            border-radius: 15px;
            border: 4px solid #FFB6C1;
            box-shadow: 0 8px 20px rgba(255, 182, 193, 0.4);
            transition: all 0.3s ease;
        }
        
        .character-image:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 30px rgba(255, 182, 193, 0.6);
        }
        
        .option {
            display: block;
            margin: 10px 0;
            padding: 12px 20px;
            background: linear-gradient(135deg, #FFE4E1, #FFF0F5);
            border: 2px solid #FFB6C1;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            color: #8B0045;
        }
        
        .option:hover {
            background: linear-gradient(135deg, #FFB6C1, #FFC0CB);
            transform: translateX(5px);
        }
        
        .option.selected {
            background: linear-gradient(135deg, #FF69B4, #FFB6C1);
            color: white;
            border-color: #D8537A;
        }
        
        .option.correct {
            background: linear-gradient(135deg, #90EE90, #98FB98);
            border-color: #228B22;
            color: #006400;
        }
        
        .option.incorrect {
            background: linear-gradient(135deg, #FFB6C1, #FFA0B4);
            border-color: #DC143C;
            color: #8B0000;
        }
        
        .quiz-result {
            text-align: center;
            padding: 20px;
            margin: 20px 0;
            border-radius: 15px;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .quiz-success {
            background: rgba(144, 238, 144, 0.3);
            color: #006400;
            border: 2px solid #228B22;
        }
        
        .quiz-failure {
            background: rgba(255, 182, 193, 0.3);
            color: #8B0000;
            border: 2px solid #DC143C;
        }
        
        .quiz-buttons {
            text-align: center;
            margin: 20px 0;
        }
        
        .quiz-btn {
            background: linear-gradient(135deg, #FF69B4, #FFB6C1);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1.1rem;
            font-family: 'Playfair Display', serif;
            margin: 0 10px;
            transition: all 0.3s ease;
        }
        
        .quiz-btn:hover {
            background: linear-gradient(135deg, #FFB6C1, #FF69B4);
            transform: translateY(-2px);
        }
        
        .quiz-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .close-btn {
            background: linear-gradient(135deg, #FF69B4, #FFB6C1);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.2rem;
            font-family: 'Playfair Display', serif;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .close-btn:hover {
            background: linear-gradient(135deg, #FFB6C1, #FF69B4);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        
        .progress-bar {
            width: 100%;
            height: 25px;
            background: #D8537A;
            border-radius: 15px;
            margin: 20px 0;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF69B4, #FFB6C1, #FF69B4);
            width: 0%;
            transition: width 0.8s ease;
            border-radius: 15px;
            position: relative;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .heart-compass {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, #CD853F, #DEB887);
            border-radius: 50%;
            border: 5px solid #8B4513;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            animation: float 3s ease-in-out infinite;
            box-shadow: 
                0 4px 15px rgba(139, 69, 19, 0.4),
                inset 0 2px 4px rgba(255,255,255,0.2);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .celebration {
            animation: celebration 3s ease-in-out;
        }
        
        @keyframes celebration {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.4) rotate(15deg); }
            50% { transform: scale(1.6) rotate(-15deg); }
            75% { transform: scale(1.4) rotate(10deg); }
        }
        
        .heart-particle {
            position: absolute;
            font-size: 1.5rem;
            color: #FF69B4;
            animation: heart-float 2s ease-out forwards;
            pointer-events: none;
        }
        
        @keyframes heart-float {
            0% {
                opacity: 1;
                transform: scale(0) translateY(0);
            }
            50% {
                opacity: 1;
                transform: scale(1) translateY(-30px);
            }
            100% {
                opacity: 0;
                transform: scale(0.5) translateY(-80px);
            }
        }
        
        .step-counter {
            position: absolute;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #F5DEB3, #DEB887);
            padding: 15px 20px;
            border-radius: 20px;
            border: 3px solid #8B4513;
            font-weight: bold;
            color: #8B4513;
            font-size: 1.1rem;
            box-shadow: 
                0 4px 10px rgba(139, 69, 19, 0.3),
                inset 0 1px 2px rgba(255,255,255,0.2);
        }
        
        @media (max-width: 768px) {
            .title {
                font-size: 2.5rem;
            }
            
            .map-container {
                padding: 20px;
            }
            
            .map-grid {
                height: 400px;
            }
            
            .location {
                width: 60px;
                height: 60px;
                font-size: 1.8rem;
            }
            
            .heart-compass {
                width: 70px;
                height: 70px;
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>

    
    <div class="container">
        <h1 class="title">üíï Mapa del Amor üíï</h1>
        <p class="subtitle">Una aventura rom√°ntica para dos corazones</p>
        
        <div class="map-container">
            <div class="heart-compass">üíñ</div>
            <div class="step-counter">Paso: <span id="currentStep">1</span> de 6</div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <div class="map-grid">
                <!-- Senderos del tesoro (siempre visibles) -->
                <div class="treasure-path path1"></div>
                <div class="treasure-path path2"></div>
                <div class="treasure-path path3"></div>
                <div class="treasure-path path4"></div>
                <div class="treasure-path path5"></div>
                

                
                <!-- Ubicaciones rom√°nticas en orden -->
                <div class="location park active" data-location="park" data-step="1" onclick="exploreLocation('park', 1)">
                    ‚ùì
                </div>
                
                <div class="location cafe" data-location="cafe" data-step="2" onclick="exploreLocation('cafe', 2)">
                    üì∑
                </div>
                
                <div class="location library" data-location="library" data-step="3" onclick="exploreLocation('library', 3)">
                    üé¨
                </div>
                
                <div class="location bridge" data-location="bridge" data-step="4" onclick="exploreLocation('bridge', 4)">
                    üåâ
                </div>
                
                <div class="location garden" data-location="garden" data-step="5" onclick="exploreLocation('garden', 5)">
                    üåπ
                </div>
                
                <div class="location surprise" data-location="surprise" data-step="6" onclick="exploreLocation('surprise', 6)">
                    üíù
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para mostrar desaf√≠os rom√°nticos -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle"></h2>
            <p id="modalText"></p>
            <div id="challengeText" class="challenge-text"></div>
            
            <!-- Quiz Container -->
            <div id="quizContainer" class="quiz-container">
                <div id="questionsContainer"></div>
                <div id="quizResult" class="quiz-result" style="display: none;"></div>
                <div class="quiz-buttons">
                    <button id="retryQuiz" class="quiz-btn" onclick="retryQuiz()" style="display: none;">Intentar de Nuevo</button>
                </div>
            </div>
            
            <!-- Photo Challenge Container -->
            <div id="photoChallengeContainer" class="photo-challenge-container">
                <div id="photoProgress" class="photo-progress"></div>
                <div id="posesContainer"></div>
                <div id="photoResult" class="quiz-result" style="display: none;"></div>
            </div>
            
            <button id="closeBtn" class="close-btn" onclick="closeModal()">¬°Desaf√≠o Completado! üíï</button>
        </div>
    </div>
    
    <script>
        let currentStep = 1;
        let completedSteps = [];
        let currentQuiz = null;
        let userAnswers = [];
        let quizPassed = false;
        let currentPhotoChallenge = null;
        let completedPoses = [];
        let photoChallengeCompleted = false;
        
        const romanticChallenges = {
            park: {
                title: "üå≥ El Parque de los Recuerdos",
                text: "Aqu√≠ comenz√≥ vuestra historia de amor. Este lugar guarda los secretos de vuestros primeros momentos juntos.",
                challenge: "DESAF√çO: Responde correctamente estas preguntas sobre nuestro primer beso para continuar la aventura rom√°ntica:",
                step: 1,
                isQuiz: true,
                questions: [
                    {
                        question: "¬øD√≥nde nos dimos nuestro primer beso?",
                        options: ["a. Coche", "b. Discoteca", "c. Jard√≠n"],
                        correct: 0 // √≠ndice de la respuesta correcta (coche = 0)
                    },
                    {
                        question: "¬øQu√© d√≠a de la semana fue?",
                        options: ["a. Lunes", "b. Martes", "c. Mi√©rcoles"],
                        correct: 0 // √≠ndice de la respuesta correcta (lunes = 0)
                    }
                ]
            },
            cafe: {
                title: "‚òï Caf√© de los Susurros",
                text: "El aroma del caf√© despierta memorias dulces. Aqu√≠ las palabras fluyen como el vapor de una taza caliente.",
                challenge: "DESAF√çO: ¬°Hora de crear recuerdos fotogr√°ficos! Imitad estas 3 poses rom√°nticas de parejas:",
                step: 2,
                isPhotoChallenge: true,
                poses: [
                    {
                        name: "Abrazo por la Espalda",
                        description: "Uno de vosotros abraza al otro por detr√°s, con las manos en la cintura. Mirad hacia el mismo lado con sonrisas naturales.",
                        emoji: "ü§ó",
                        tips: "Consejo: El que abraza debe apoyar suavemente la barbilla en el hombro del otro.",
                        imageSvg: `<svg width="160" height="120" viewBox="0 0 160 120" xmlns="http://www.w3.org/2000/svg">
                            <!-- Persona de atr√°s -->
                            <circle cx="90" cy="25" r="12" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <rect x="82" y="35" width="16" height="25" rx="8" fill="#FF69B4" stroke="#D8537A" stroke-width="2"/>
                            <rect x="78" y="60" width="8" height="20" rx="4" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <rect x="94" y="60" width="8" height="20" rx="4" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <!-- Brazos abrazando -->
                            <path d="M 82 45 Q 65 50 60 55 Q 58 58 62 60" fill="none" stroke="#D8537A" stroke-width="3" stroke-linecap="round"/>
                            <path d="M 98 45 Q 115 50 120 55 Q 122 58 118 60" fill="none" stroke="#D8537A" stroke-width="3" stroke-linecap="round"/>
                            <!-- Persona de adelante -->
                            <circle cx="80" cy="30" r="12" fill="#FFC0CB" stroke="#D8537A" stroke-width="2"/>
                            <rect x="72" y="40" width="16" height="25" rx="8" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <rect x="68" y="65" width="8" height="20" rx="4" fill="#FFC0CB" stroke="#D8537A" stroke-width="2"/>
                            <rect x="84" y="65" width="8" height="20" rx="4" fill="#FFC0CB" stroke="#D8537A" stroke-width="2"/>
                            <!-- Corazones -->
                            <text x="40" y="25" font-size="12" fill="#FF69B4">üíï</text>
                            <text x="130" y="35" font-size="10" fill="#FF69B4">üíñ</text>
                        </svg>`
                    },
                    {
                        name: "Frente a Frente",
                        description: "Poneos frente a frente, muy cerca. Tocad vuestras frentes y cerrad los ojos. Las manos pueden estar en las mejillas del otro.",
                        emoji: "üíï",
                        tips: "Consejo: Respirad profundo y disfrutad del momento √≠ntimo antes de la foto.",
                        imageSvg: `<svg width="160" height="120" viewBox="0 0 160 120" xmlns="http://www.w3.org/2000/svg">
                            <!-- Persona izquierda -->
                            <circle cx="60" cy="35" r="15" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <rect x="50" y="48" width="20" height="30" rx="10" fill="#FF69B4" stroke="#D8537A" stroke-width="2"/>
                            <rect x="45" y="78" width="10" height="25" rx="5" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <rect x="65" y="78" width="10" height="25" rx="5" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <!-- Persona derecha -->
                            <circle cx="100" cy="35" r="15" fill="#FFC0CB" stroke="#D8537A" stroke-width="2"/>
                            <rect x="90" y="48" width="20" height="30" rx="10" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <rect x="85" y="78" width="10" height="25" rx="5" fill="#FFC0CB" stroke="#D8537A" stroke-width="2"/>
                            <rect x="105" y="78" width="10" height="25" rx="5" fill="#FFC0CB" stroke="#D8537A" stroke-width="2"/>
                            <!-- Brazos tocando mejillas -->
                            <path d="M 70 55 Q 85 45 95 40" fill="none" stroke="#D8537A" stroke-width="3" stroke-linecap="round"/>
                            <path d="M 90 55 Q 75 45 65 40" fill="none" stroke="#D8537A" stroke-width="3" stroke-linecap="round"/>
                            <!-- L√≠nea conectando frentes -->
                            <line x1="75" y1="35" x2="85" y2="35" stroke="#FF69B4" stroke-width="2" stroke-dasharray="3,3"/>
                            <!-- Corazones flotando -->
                            <text x="75" y="20" font-size="14" fill="#FF69B4">üíï</text>
                            <text x="30" y="40" font-size="10" fill="#FF69B4">üíñ</text>
                            <text x="120" y="50" font-size="10" fill="#FF69B4">üíó</text>
                        </svg>`
                    },
                    {
                        name: "Baile Rom√°ntico",
                        description: "Posici√≥n de baile cl√°sico: una mano en la cintura, la otra entrelazada. Miradas conectadas y sonrisas genuinas.",
                        emoji: "üíÉ",
                        tips: "Consejo: Imaginad que est√°is bailando vuestra canci√≥n favorita.",
                        imageSvg: `<svg width="160" height="120" viewBox="0 0 160 120" xmlns="http://www.w3.org/2000/svg">
                            <!-- Persona izquierda (l√≠der) -->
                            <circle cx="65" cy="30" r="12" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <rect x="57" y="40" width="16" height="28" rx="8" fill="#FF69B4" stroke="#D8537A" stroke-width="2"/>
                            <rect x="53" y="68" width="8" height="22" rx="4" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <rect x="69" y="68" width="8" height="22" rx="4" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <!-- Persona derecha -->
                            <circle cx="95" cy="30" r="12" fill="#FFC0CB" stroke="#D8537A" stroke-width="2"/>
                            <rect x="87" y="40" width="16" height="28" rx="8" fill="#FFB6C1" stroke="#D8537A" stroke-width="2"/>
                            <rect x="83" y="68" width="8" height="22" rx="4" fill="#FFC0CB" stroke="#D8537A" stroke-width="2"/>
                            <rect x="99" y="68" width="8" height="22" rx="4" fill="#FFC0CB" stroke="#D8537A" stroke-width="2"/>
                            <!-- Manos entrelazadas arriba -->
                            <circle cx="80" cy="35" r="4" fill="#FF69B4" stroke="#D8537A" stroke-width="2"/>
                            <path d="M 73 42 Q 80 35 87 42" fill="none" stroke="#D8537A" stroke-width="3" stroke-linecap="round"/>
                            <!-- Mano en la cintura -->
                            <path d="M 57 50 Q 75 55 87 52" fill="none" stroke="#D8537A" stroke-width="3" stroke-linecap="round"/>
                            <!-- Notas musicales -->
                            <text x="40" y="25" font-size="12" fill="#FF69B4">‚ô™</text>
                            <text x="115" y="35" font-size="10" fill="#FF69B4">‚ô´</text>
                            <text x="45" y="70" font-size="8" fill="#FF69B4">‚ô™</text>
                            <!-- Corazones -->
                            <text x="80" y="15" font-size="12" fill="#FF69B4">üíï</text>
                            <text x="120" y="60" font-size="10" fill="#FF69B4">üíñ</text>
                        </svg>`
                    }
                ]
            },
            library: {
                title: "üìö Biblioteca de los Sue√±os",
                text: "Entre p√°ginas y susurros, los sue√±os cobran vida. En esta biblioteca m√°gica, las historias √©picas cobran vida.",
                challenge: "DESAF√çO: ¬°Demuestra tu conocimiento de Juego de Tronos! Identifica correctamente estos 3 personajes para continuar:",
                step: 3,
                isQuiz: true,
                questions: [
                    {
                        question: "¬øQui√©n es este personaje?",
                        character: "Jon Snow",
                        imageUrl: "https://github.com/pablo-Tesoro/mapa/blob/main/docs/jon-snow.jpg",
                        options: ["a. Jon Snow", "b. Robb Stark", "c. Ned Stark"],
                        correct: 0
                    },
                    {
                        question: "¬øQui√©n es esta personaje?",
                        character: "Daenerys Targaryen",
                        imageUrl: "https://github.com/pablo-Tesoro/mapa/blob/main/docs/daenerys.jpg",
                        options: ["a. Cersei Lannister", "b. Daenerys Targaryen", "c. Sansa Stark"],
                        correct: 1
                    },
                    {
                        question: "¬øQui√©n es este personaje?",
                        character: "Tyrion Lannister",
                        imageUrl: "https://github.com/pablo-Tesoro/mapa/blob/main/docs/tyrion.jpg",
                        options: ["a. Jaime Lannister", "b. Tyrion Lannister", "c. Tywin Lannister"],
                        correct: 1
                    }
                ]
            },
            bridge: {
                title: "üåâ Puente de las Promesas",
                text: "Este puente conecta no solo dos orillas, sino dos corazones. Aqu√≠ las promesas se vuelven eternas.",
                challenge: "DESAF√çO: Haced una promesa rom√°ntica el uno al otro para el pr√≥ximo a√±o. Selladla con un beso bajo las estrellas (o luces del puente).",
                step: 4
            },
            garden: {
                title: "üåπ Jard√≠n de los Sentimientos",
                text: "Como las flores que florecen, vuestro amor crece cada d√≠a. Cada p√©talo representa un momento especial compartido.",
                challenge: "DESAF√çO: Recoged (o imaginad) cinco flores diferentes. Cada una representa una cualidad que am√°is del otro. Explicad por qu√© elegisteis cada flor.",
                step: 5
            },
            surprise: {
                title: "üíù ¬°La Sorpresa Final!",
                text: "¬°Felicidades, pareja aventurera! Hab√©is completado el mapa del amor y demostrado que vuestro amor puede superar cualquier desaf√≠o.",
                challenge: "RECOMPENSA FINAL: ¬°Aqu√≠ est√° vuestra sorpresa especial! (Aqu√≠ puedes poner tu sorpresa real: una cena, un regalo, un viaje, etc.) ¬°Hab√©is ganado una noche m√°gica juntos! üéâ‚ú®",
                step: 6,
                isFinal: true
            }
        };
        
        function exploreLocation(locationName, step) {
            // Solo permitir el paso actual
            if (step !== currentStep) {
                if (step < currentStep) {
                    // Ya completado
                    return;
                } else {
                    // Mostrar mensaje de que debe completar pasos anteriores
                    alert("¬°Debes completar los desaf√≠os en orden! üíï");
                    return;
                }
            }
            
            const challenge = romanticChallenges[locationName];
            
            // Mostrar modal con desaf√≠o
            document.getElementById('modalTitle').textContent = challenge.title;
            document.getElementById('modalText').textContent = challenge.text;
            document.getElementById('challengeText').textContent = challenge.challenge;
            
            // Si es un quiz, configurarlo
            if (challenge.isQuiz) {
                setupQuiz(challenge);
                document.getElementById('closeBtn').style.display = 'none';
                document.getElementById('photoChallengeContainer').style.display = 'none';
            } else if (challenge.isPhotoChallenge) {
                setupPhotoChallenge(challenge);
                document.getElementById('closeBtn').style.display = 'none';
                document.getElementById('quizContainer').style.display = 'none';
            } else {
                document.getElementById('quizContainer').style.display = 'none';
                document.getElementById('photoChallengeContainer').style.display = 'none';
                document.getElementById('closeBtn').style.display = 'block';
                // Completar inmediatamente para desaf√≠os normales
                completeChallenge(locationName, step);
            }
            
            document.getElementById('modal').style.display = 'block';
        }
        
        function setupQuiz(challenge) {
            currentQuiz = challenge;
            userAnswers = [];
            quizPassed = false;
            currentQuiz.currentQuestionIndex = 0;
            
            document.getElementById('quizContainer').style.display = 'block';
            document.getElementById('quizResult').style.display = 'none';
            document.getElementById('retryQuiz').style.display = 'none';
            
            showCurrentQuestion();
        }
        
        function showCurrentQuestion() {
            const questionsContainer = document.getElementById('questionsContainer');
            questionsContainer.innerHTML = '';
            
            const currentIndex = currentQuiz.currentQuestionIndex;
            const q = currentQuiz.questions[currentIndex];
            
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question';
            questionDiv.innerHTML = `
                <h3>Pregunta ${currentIndex + 1} de ${currentQuiz.questions.length}</h3>
                <h3>${q.question}</h3>
                ${q.imageUrl ? `
                    <div class="character-image-container">
                        <img src="${q.imageUrl}" alt="${q.character}" class="character-image" />
                    </div>
                ` : ''}
                ${q.options.map((option, optIndex) => `
                    <div class="option" onclick="selectQuizOption(${optIndex})" data-option="${optIndex}">
                        ${option}
                    </div>
                `).join('')}
            `;
            questionsContainer.appendChild(questionDiv);
        }
        
        function selectQuizOption(optionIndex) {
            const currentIndex = currentQuiz.currentQuestionIndex;
            const correctAnswer = currentQuiz.questions[currentIndex].correct;
            
            // Guardar respuesta
            userAnswers[currentIndex] = optionIndex;
            
            // Marcar la opci√≥n seleccionada
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
                opt.classList.remove('selected');
            });
            
            const selectedOption = document.querySelector(`[data-option="${optionIndex}"]`);
            selectedOption.classList.add('selected');
            
            // Esperar un momento y luego proceder
            setTimeout(() => {
                if (optionIndex === correctAnswer) {
                    // Respuesta correcta
                    selectedOption.classList.add('correct');
                    setTimeout(() => {
                        proceedToNextQuestion();
                    }, 1500);
                } else {
                    // Respuesta incorrecta
                    selectedOption.classList.add('incorrect');
                    setTimeout(() => {
                        showIncorrectMessage();
                    }, 1500);
                }
            }, 500);
        }
        
        function proceedToNextQuestion() {
            currentQuiz.currentQuestionIndex++;
            
            if (currentQuiz.currentQuestionIndex >= currentQuiz.questions.length) {
                // Todas las preguntas respondidas correctamente
                showQuizSuccess();
            } else {
                // Mostrar siguiente pregunta
                showCurrentQuestion();
            }
        }
        
        function showIncorrectMessage() {
            const resultDiv = document.getElementById('quizResult');
            resultDiv.className = 'quiz-result quiz-failure';
            resultDiv.textContent = '¬°Ups! üíî Esa respuesta no es correcta. ¬°Int√©ntalo de nuevo!';
            resultDiv.style.display = 'block';
            document.getElementById('retryQuiz').style.display = 'inline-block';
        }
        
        function showQuizSuccess() {
            const resultDiv = document.getElementById('quizResult');
            resultDiv.className = 'quiz-result quiz-success';
            resultDiv.textContent = '¬°Perfecto! üíï Todas las respuestas son correctas. ¬°Puedes continuar con la aventura!';
            resultDiv.style.display = 'block';
            quizPassed = true;
            document.getElementById('closeBtn').style.display = 'block';
            document.getElementById('closeBtn').textContent = '¬°Continuar Aventura! üíï';
            
            // Ocultar el contenedor de preguntas
            document.getElementById('questionsContainer').innerHTML = '';
        }
        
        function retryQuiz() {
            // Resetear el quiz
            userAnswers = [];
            currentQuiz.currentQuestionIndex = 0;
            
            document.getElementById('quizResult').style.display = 'none';
            document.getElementById('retryQuiz').style.display = 'none';
            document.getElementById('closeBtn').style.display = 'none';
            
            // Mostrar la primera pregunta de nuevo
            showCurrentQuestion();
        }
        
        function setupPhotoChallenge(challenge) {
            currentPhotoChallenge = challenge;
            completedPoses = [];
            photoChallengeCompleted = false;
            
            document.getElementById('photoChallengeContainer').style.display = 'block';
            document.getElementById('photoResult').style.display = 'none';
            
            showPhotoPoses();
        }
        
        function showPhotoPoses() {
            const posesContainer = document.getElementById('posesContainer');
            const progressDiv = document.getElementById('photoProgress');
            
            progressDiv.textContent = `Poses completadas: ${completedPoses.length} de ${currentPhotoChallenge.poses.length}`;
            
            posesContainer.innerHTML = '';
            
            currentPhotoChallenge.poses.forEach((pose, index) => {
                const isCompleted = completedPoses.includes(index);
                
                const poseCard = document.createElement('div');
                poseCard.className = `pose-card ${isCompleted ? 'completed' : ''}`;
                poseCard.innerHTML = `
                    <span class="pose-emoji">${pose.emoji}</span>
                    <div class="pose-name">${pose.name}</div>
                    <div class="pose-image">
                        ${pose.imageSvg}
                    </div>
                    <div class="pose-description">${pose.description}</div>
                    <div class="pose-tips">${pose.tips}</div>
                    <button class="pose-button ${isCompleted ? 'completed' : ''}" 
                            onclick="completePose(${index})" 
                            ${isCompleted ? 'disabled' : ''}>
                        ${isCompleted ? '‚úÖ ¬°Completada!' : 'üì∏ ¬°Foto Tomada!'}
                    </button>
                `;
                posesContainer.appendChild(poseCard);
            });
        }
        
        function completePose(poseIndex) {
            if (!completedPoses.includes(poseIndex)) {
                completedPoses.push(poseIndex);
                
                // Crear efecto de corazones
                const poseCard = document.querySelectorAll('.pose-card')[poseIndex];
                createHeartParticles(poseCard);
                
                // Actualizar la vista
                showPhotoPoses();
                
                // Verificar si todas las poses est√°n completadas
                if (completedPoses.length === currentPhotoChallenge.poses.length) {
                    setTimeout(() => {
                        showPhotoChallengeSuccess();
                    }, 1000);
                }
            }
        }
        
        function showPhotoChallengeSuccess() {
            const resultDiv = document.getElementById('photoResult');
            resultDiv.className = 'quiz-result quiz-success';
            resultDiv.textContent = '¬°Fant√°stico! üì∏üíï Hab√©is completado todas las poses rom√°nticas. ¬°Qu√© recuerdos tan hermosos hab√©is creado!';
            resultDiv.style.display = 'block';
            photoChallengeCompleted = true;
            document.getElementById('closeBtn').style.display = 'block';
            document.getElementById('closeBtn').textContent = '¬°Continuar Aventura! üíï';
            
            // Ocultar las poses
            document.getElementById('posesContainer').innerHTML = '';
            document.getElementById('photoProgress').style.display = 'none';
        }
        
        function completeChallenge(locationName, step) {
            // Marcar como completado
            completedSteps.push(step);
            const locationElement = document.querySelector(`[data-location="${locationName}"]`);
            locationElement.classList.remove('active');
            locationElement.classList.add('completed');
            
            // Actualizar progreso
            updateProgress();
            
            // Activar siguiente ubicaci√≥n
            if (step < 6) {
                activateNextLocation(step + 1);
            }
            
            // Efectos especiales
            const challenge = romanticChallenges[locationName];
            if (challenge.isFinal) {
                celebrateFinalSurprise(locationElement);
            } else {
                createHeartParticles(locationElement);
            }
        }
        
        function updateProgress() {
            const progress = (completedSteps.length / 6) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('currentStep').textContent = currentStep + 1;
            currentStep++;
        }
        
        function activateNextLocation(nextStep) {
            if (nextStep <= 6) {
                const nextLocation = document.querySelector(`[data-step="${nextStep}"]`);
                if (nextLocation) {
                    nextLocation.classList.add('active');
                }
            }
        }
        
        // Los senderos ya est√°n visibles en el mapa
        
        function celebrateFinalSurprise(element) {
            element.classList.add('celebration');
            
            // Crear muchos corazones
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    createHeartParticles(element);
                }, i * 150);
            }
        }
        
        function createHeartParticles(element) {
            const hearts = ['üíï', 'üíñ', 'üíó', 'üíò', 'üíù'];
            
            for (let i = 0; i < 3; i++) {
                const heart = document.createElement('div');
                heart.className = 'heart-particle';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                
                const rect = element.getBoundingClientRect();
                const containerRect = element.parentElement.getBoundingClientRect();
                
                heart.style.left = (rect.left - containerRect.left + Math.random() * 70) + 'px';
                heart.style.top = (rect.top - containerRect.top + Math.random() * 70) + 'px';
                
                element.parentElement.appendChild(heart);
                
                setTimeout(() => {
                    heart.remove();
                }, 2000);
            }
        }
        
        function closeModal() {
            // Solo cerrar si no hay desaf√≠os activos o si fueron completados
            if ((!currentQuiz || quizPassed) && (!currentPhotoChallenge || photoChallengeCompleted)) {
                if (currentQuiz && quizPassed) {
                    // Completar el desaf√≠o del quiz seg√∫n la ubicaci√≥n
                    if (currentQuiz.step === 1) {
                        completeChallenge('park', 1);
                    } else if (currentQuiz.step === 3) {
                        completeChallenge('library', 3);
                    }
                    currentQuiz = null;
                    quizPassed = false;
                }
                if (currentPhotoChallenge && photoChallengeCompleted) {
                    // Completar el desaf√≠o de fotos
                    completeChallenge('cafe', 2);
                    currentPhotoChallenge = null;
                    photoChallengeCompleted = false;
                    completedPoses = [];
                }
                document.getElementById('modal').style.display = 'none';
            }
        }
        
        // Cerrar modal al hacer clic fuera
        window.onclick = function(event) {
            const modal = document.getElementById('modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }
        
        // Animaci√≥n de entrada
        window.addEventListener('load', function() {
            const locations = document.querySelectorAll('.location');
            locations.forEach((location, index) => {
                setTimeout(() => {
                    location.style.transform = 'scale(1)';
                }, index * 300);
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96a782c8e2cecea7',t:'MTc1NDQwOTY2My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
